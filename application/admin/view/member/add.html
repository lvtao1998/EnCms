{extend name="index_layout"/}
{block name="main"}
<div class="layui-card">
	<div class="layui-card-header">注册会员</div>
    <div class="layui-card-body">
        <form class="layui-form" method="post">
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" lay-verify="required" name="username" placeholder="用户名">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">头像宽度</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="widths" id="widths" placeholder="头像宽度">
                </div>
                <div class="layui-form-mid layui-word-aux">px</div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">头像高度</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="heights" id="heights" placeholder="头像高度">
                </div>
                <div class="layui-form-mid layui-word-aux">px</div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">头　像</label>
                <div class="layui-input-inline">
                    <button type="button" class="layui-btn" id="test1">上传</button>
                    <div class="layui-upload-list">
                        <input type="hidden" id="avatar">
                        <img class="layui-upload-img" style="width: 100px" id="demo1">
                        <p id="demoText"></p>
                    </div>
                    <div id="bs"></div>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">密　码</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" lay-verify="required" name="password" placeholder="密　码">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">确　认</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" lay-verify="required" name="repassword" placeholder="确　认">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">提　问</label>
                <div class="layui-input-inline">
                  <select name="question" lay-filter="question">
                    <option value="0">无安全提问</option>
                    <option value="1">母亲的名字</option>
                    <option value="2">爷爷的名字</option>
                    <option value="3">父亲出生的城市</option>
                    <option value="4">你其中一位老师的名字</option>
                    <option value="5">你个人计算机的型号</option>
                    <option value="6">你最喜欢的餐馆名称</option>
                    <option value="7">驾驶执照最后四位数字</option>
                  </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">回　答</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="answer" placeholder="回　答">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">姓　名</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" lay-verify="required" name="cnname" placeholder="姓　名">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">英文名</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="enname" placeholder="英文名">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">性　别</label>
                <div class="layui-input-inline">
                  <input type="radio" name="sex" value="0" title="男" checked="">
                  <input type="radio" name="sex" value="1" title="女">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">生　日</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" lay-verify="required" id="test17" readonly="" name="birth" placeholder="生　日">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">星　座</label>
                <div class="layui-input-inline">
                  <select name="astro" lay-filter="astro" lay-verify="required">
                    <option value=""></option>
                    <option value="0">白羊座</option>
                    <option value="1">金牛座</option>
                    <option value="2">双子座</option>
                    <option value="3">巨蟹座</option>
                    <option value="4">狮子座</option>
                    <option value="5">处女座</option>
                    <option value="6">天枰座</option>
                    <option value="7">天蝎座</option>
                    <option value="8">射手座</option>
                    <option value="9">摩羯座</option>
                    <option value="10">水瓶座</option>
                    <option value="11">双鱼座</option>
                  </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">证件号码</label>
                <div class="layui-input-inline">
                  <select name="cardtype" lay-filter="cardtype" lay-verify="required">
                    <option value=""></option>
                    <option value="0">身份证</option>
                    <option value="1">护照</option>
                    <option value="2">驾驶证</option>
                  </select>
                  <input type="text" class="layui-input" name="cardnum" placeholder="证件号码">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">个人说明</label>
                <div class="layui-input-inline">
                  <textarea class="layui-textarea" name="intro" placeholder="个人说明"></textarea>
                </div>
                <div class="layui-form-mid layui-word-aux">最多输入255字符</div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">E-mail</label>
                <div class="layui-input-inline">
                    <input type="email" class="layui-input" name="email" placeholder="E-mail">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">QQ号码</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="qqnum" placeholder="QQ号码">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">手　机</label>
                <div class="layui-input-inline">
                    <input type="tel" class="layui-input" name="mobile" placeholder="手　机">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">认证用户</label>
                <div class="layui-input-inline">
                  <input type="checkbox" name="enteruser" lay-skin="primary" title="是" value="1">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">经验值</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="expval" placeholder="经验值">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">积　分</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="integral" placeholder="积　分">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">注册时间</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" name="regtime" value="{$time}" readonly="readonly" id="test5" placeholder="yyyy-MM-dd HH:mm:ss">
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="formSubmit">立即提交</button>
                </div>
            </div>
        </form>
    </div>
</div>
{/block}
{block name="script"}
<script>
layui.use('upload', function(){
  var $ = layui.jquery
  ,upload = layui.upload;
  
  //普通图片上传
  var uploadInst = upload.render({
    elem: '#test1'
    ,url: "{:url('Upload/upload')}" //改成您自己的上传接口
    ,data:{
      width: function(){
        return $('#widths').val();
      },
      height: function(){
        return $('#heights').val();
      },
    }
    ,before: function(obj){
        layer.load(); //上传loading
      //预读本地文件示例，不支持ie8
      obj.preview(function(index, file, result){
        $('#demo1').attr('src', result); //图片链接（base64）
      });
    }
    ,done: function(res){
      //如果上传失败
      if(res.code > 0){
        return layer.msg('上传失败');
      }
      //上传成功
      $("#avatar").attr('name','avatar');
      $("#avatar").attr('value',res['data']['src']);
      $("#bs").html("");
      $("#bs").append('<button type="button" onclick="delImg()" class="layui-btn layui-btn-normal layui-btn-sm"><i class="layui-icon"></i></button>');
      layer.closeAll('loading'); //关闭loading
    }
    ,error: function(){
      //演示失败状态，并实现重传
      var demoText = $('#demoText');
      demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
      demoText.find('.demo-reload').on('click', function(){
        uploadInst.upload();
      });
    }
  });   
});
function delImg(){
    layer.load(); //上传loading
  var picurl = $("#avatar").val();
  $.ajax({
    url:"{:url('Upload/delImg')}",
    type:"post",
    data:{picurl:picurl},
    success(e){
        if(e.code>0){
            $('#demo1').attr("src","")
            $("#avatar").attr("value","")
            $("#bs").html("")
            layer.closeAll('loading'); //关闭loading
            layer.msg(e.msg);
        }else{
            layer.closeAll('loading'); //关闭loading
            layer.msg(e.msg);
        }
    }
  })
}  
</script>
<script>
layui.use('laydate', function(){
  var laydate = layui.laydate;
  //日期时间选择器
  laydate.render({
    elem: '#test5'
    ,type: 'datetime'
  });
  //开启公历节日
  laydate.render({
    elem: '#test17'
    ,calendar: true
  });
});
</script>
{/block}